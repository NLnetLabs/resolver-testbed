# Technical Plan for the Resolver Testbed

@@ Using VirtualBox first, can extend to Workstation/Fusion later

@@ Uses multiple networks to segregate traffic so that packet captures are cleaner

## Network Layout

![Network diagram](file://./testbed-layout.png =794x262)
<!-- =1058x350 -->

 * control network: host-only (**vboxnet0**)
 * resolvers network: internal (**resnet**)
 * servers network: internal  (**servnet**)
 * Internet: bridged, addresses from DHCP
 
 ## Control Host

The system that controls the testbed runs on any standard computer.
The control host has all of the configuration files, some of which are generated by Python scripts that are run before testing.
It pushes all the configurations to the VMs, and controls the testing by starting the recording and initiating the
tests over SSH.

The control host has two NICs:

 * **cc** on the control network (192.168.56.1)
 * **ci** on the Internet (via DHCP)

## VM Functionality and Network Connections

### Gateway VM

**gateway-vm** acts as an enhanced default router for the resolvers.
It has many functions:

 * Routing with interfaces for the resolvers, the simulated roots, and the Internet
 * Packet capture, logging, and display during tests
 * Delaying of packets bound for the simulated root servers
 
gateway-vm has four NICs:
 
 * **gc** on the control network (192.168.56.2)
 * **gr** on the resolvers network (172.20.1.1)
 * **gs** on the servers network (172.21.1.1)
 * **gi** on the Internet (via DHCP)
 
### Root Servers VM

**servers-vm** is all the simulated root servers on a single VM.

servers-vm has two NICs:

 * **sc** on the control network (192.168.56.3)
 * **ss** on the servers network (172.21.1.2)

### Resolver Systems

There can be multiple VMs that run the resolvers under test.
These include:

 * **resolvers-vm** contains numerous resolvers that are build
 from source under Debian.
 * Some tests will be for resolvers in their default configuration
 in Linux OS distributions, and will thus each need their own VM
 * Some tests will be for non-Linux VMs, particularly Windows Server
 * Resolvers running in hardware will possibly be supported

The resolvers-vm will allow building of many (but unfortunately not all) open source
resolvers.

Each resolver system has two NICs:

 * **rc** on the control network (192.168.56.4)
 * **rr** on the resolvers network (172.20.1.2)

